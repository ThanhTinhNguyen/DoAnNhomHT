CREATE DATABASE QuanLyHocSinh
USE [QuanLyHocSinh]
GO
CREATE TABLE ACCOUNT
(
	USERNAME NVARCHAR (100) PRIMARY KEY,
	DISPLAYNAME NVARCHAR (100) NOT NULL,
	PASSWORD NVARCHAR (1000) NOT NULL,
	TYPE INT NOT NULL
)
GO
CREATE TABLE [dbo].[BANGDIEMMONHOC](
	[MABANGDIEM] [nvarchar](50) PRIMARY KEY NOT NULL,
	[DIEM15PHUT] [float] NULL,
	[DIEM1TIET] [float] NULL,
	[DIEMTB] [float] NULL,
	[MAMON] [nvarchar](50) NULL,
	[MAHOCKI] [nvarchar](50) NULL,
	[MADANHSACH] [nvarchar](50) NULL
	)
	GO
CREATE TABLE [dbo].[DANHSACHLOP](
	[MADANHSACH] [nvarchar](50) PRIMARY KEY NOT NULL,
	[MAHS] [nvarchar](50) NULL,
	[TBHKI] [float] NULL,
	[TBHKII] [float] NULL)

	GO
CREATE TABLE [dbo].[HOCKI](
	[MAHOCKI] [nvarchar](50) PRIMARY KEY NOT NULL,
	[TENHOCKI] [nvarchar](50) NULL)

	GO
CREATE TABLE [dbo].[HOCSINH](
	[MAHS] [nvarchar](50)PRIMARY KEY NOT NULL,
	[HOTEN] [nvarchar](50) NULL,
	[GIOITINH] [nvarchar](50) NULL,
	[NGAYSINH] DATE NOT NULL,
	[DIACHI] [nvarchar](50) NULL,
	[EMAIL] [nvarchar](50) NULL,
	[MALOP] [nvarchar](50) NULL)
	GO
CREATE TABLE [dbo].[KHOI](
	[MAKHOI] [nvarchar](50) PRIMARY KEY NOT NULL,
	[TENKHOI] [nvarchar](50) NULL)
	GO
	CREATE TABLE [dbo].[LOP](
	[MALOP] [nvarchar](50) PRIMARY KEY NOT NULL,
	[TENLOP] [nvarchar](50) NULL,
	[SISO] [nvarchar](50) NULL,
	[MAKHOI] [nvarchar](50) NULL)

	GO
CREATE TABLE [dbo].[MON](
	[MAMON] [nvarchar](50) PRIMARY KEY NOT NULL,
	[TENMON] [nvarchar](50) NULL)

	GO

INSERT INTO ACCOUNT (USERNAME,DISPLAYNAME,PASSWORD,TYPE) VALUES (N'HUU',N'HUU',N'1',1);


GO

INSERT [dbo].[KHOI] ([MAKHOI], [TENKHOI]) VALUES (N'K10', N'Khối 10')
INSERT [dbo].[KHOI] ([MAKHOI], [TENKHOI]) VALUES (N'K11', N'Khối 11')
INSERT [dbo].[KHOI] ([MAKHOI], [TENKHOI]) VALUES (N'K12', N'Khối 12')

GO
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L10A1', N'10A1', N'3', N'K10')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L10A2', N'10A2', N'3', N'K10')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L10A3', N'10A3', N'3', N'K10')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L10A4', N'10A4', N'3', N'K10')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L11A1', N'11A1', N'3', N'K11')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L11A2', N'11A2', N'3', N'K11')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L11A3', N'11A3', N'3', N'K11')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L12A1', N'12A1', N'3', N'K12')
INSERT [dbo].[LOP] ([MALOP], [TENLOP], [SISO], [MAKHOI]) VALUES (N'L12A2', N'12A2', N'3', N'K12')
GO
GO
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS04', N'Đinh Minh Chí', N'Nam','12/30/2001', NULL, NULL, N'L10A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS05', N'Trần Văn Rin', N'Nam','12/30/2001', NULL, NULL, N'L10A4')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS06', N'Nguyễn Văn Trọng Khoa', N'Nam','12/27/2001' , NULL, NULL, N'L10A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS07', N'Nguyễn Văn Duy', N'Nam','2/27/2001', NULL, NULL, N'L10A3')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS08', N'Đặng Ngọc Thùy Dung', N'Nữ','2/3/2001', NULL, NULL, N'L10A4')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS09', N'Đặng Ngọc Kim Khánh', N'Nữ', '12/30/2000', NULL, NULL, N'L10A3')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS10', N'Đoàn Nam Minh', N'Nam','12/30/2000', NULL, NULL, N'L10A4')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS11', N'Lý Hoa Nam', N'Nam','12/30/2002', NULL, NULL, N'L10A4')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS12', N'Vũ Lê Hoàng Minh', N'Nam','12/30/2002', NULL, NULL, N'L10A4')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS13', N'Nguyễn Thị Ngọc Thảo', N'Nữ','03/11/2002', NULL, NULL, N'L11A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS14', N'Huỳnh Thị Thanh Thúy', N'Nữ','04/22/2001', NULL, NULL, N'L11A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS15', N'Phạm Bảo Hoàng Huy', N'Nam','12/30/2001', NULL, NULL, N'L11A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS16', N'Phạm Trần Hạnh Dung', N'Nữ','12/30/2001', NULL, NULL, N'L11A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS17', N'Nguyễn Quỳnh Như', N'Nữ','12/30/2001', NULL, NULL, N'L11A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS18', N'Hồ Thị Mỹ Xinh', N'Nữ','12/30/2001', NULL, NULL, N'L11A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS19', N'Nguyễn Thế Huyền Trân', N'Nữ', '12/30/2001', NULL, NULL, N'L11A3')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS20', N'Trần Lê Gia Hồng Phúc', N'Nam', '12/30/2001', NULL, NULL, N'L11A3')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS21', N'Nguyễn Minh Kiều Trang',N'Nữ' ,'12/30/2001', NULL, NULL, N'L11A3')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS22', N'Nguyễn Thùy Trang', N'Nữ','12/30/2000' , NULL, NULL, N'L12A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS23', N'Nguyễn Minh Tiến', N'Nam','12/30/2000', NULL, NULL, N'L12A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS24', N'Lâm Hữu Trọng', N'Nam', '12/30/2000' , NULL, NULL, N'L12A1')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS25', N'Phạm Quang Nhựt', N'Nam','12/30/2000' ,NULL, NULL, N'L12A2')
INSERT [dbo].[HOCSINH] ([MAHS], [HOTEN], [GIOITINH], [NGAYSINH], [DIACHI], [EMAIL], [MALOP]) VALUES (N'HS27', N'Võ Thị Kiều My', N'Nữ','12/30/2000 ', NULL, NULL, N'L12A2')

GO

ALTER TABLE [dbo].[HOCSINH]  WITH CHECK ADD  CONSTRAINT [FK_HOCSINH_LOP] FOREIGN KEY([MALOP])
REFERENCES [dbo].[LOP] ([MALOP])

ALTER TABLE [dbo].[LOP]  WITH CHECK ADD  CONSTRAINT [FK_LOP_KHOI] FOREIGN KEY([MAKHOI])
REFERENCES [dbo].[KHOI] ([MAKHOI])

GO
ALTER TABLE [dbo].[BANGDIEMMONHOC]  WITH CHECK ADD  CONSTRAINT [FK_BANGDIEMMONHOC_MON] FOREIGN KEY([MAMON])
REFERENCES [dbo].[MON] ([MAMON])
GO
ALTER TABLE [dbo].[BANGDIEMMONHOC]  WITH CHECK ADD  CONSTRAINT [FK_BANGDIEMMONHOC_HOCKI] FOREIGN KEY([MAHOCKI])
REFERENCES [dbo].[HOCKI] ([MAHOCKI])


GO
CREATE PROC USP_LOGIN
@UserName NVARCHAR(100),@PassWord NVARCHAR(100)
AS
BEGIN
SELECT* FROM ACCOUNT WHERE USERNAME=@UserName AND PASSWORD=@PassWord
END
EXEC USP_LOGIN huu ,1
SELECT* FROM ACCOUNT WHERE USERNAME='huu' AND PASSWORD=1
GO
CREATE PROC USP_GETSTUDENTLIST
AS
SELECT * FROM HOCSINH 
EXEC USP_STUDENTLIST
GO
CREATE PROC USP_GETGRADELIST
AS
SELECT * FROM KHOI 
GO
CREATE PROC USP_GETNEWSTUDENTLIST
AS
BEGIN
SELECT * FROM HOCSINH
WHERE MALOP=N'L11A2'
END
EXEC USP_GETNEWSTUDENTLIST


CREATE PROC USP_DELETE
@MaHS NVARCHAR(100)
AS
BEGIN
DELETE HOCSINH WHERE MAHS = @MaHS 
END
CREATE PROC USP_GETCLASSLIST
@MaKhoi NVARCHAR(100)
AS
BEGIN
SELECT* FROM LOP WHERE MAKHOI = @MaKhoi 
END
SELECT* FROM HOCSINH
WHERE MALOP=''

SELECT COUNT(MAHS)
FROM HOCSINH WHERE MALOP=N'L11A2'